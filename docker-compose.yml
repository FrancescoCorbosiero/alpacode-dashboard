# =============================================
# Alpacode Dashboard - Local Development
# =============================================
#
# Start:   docker-compose up -d
# Stop:    docker-compose down
# Logs:    docker-compose logs -f postgres
# Reset:   docker-compose down -v  (deletes data!)
#
# =============================================

services:
  postgres:
    image: postgres:16-alpine
    container_name: alpacode-postgres
    restart: unless-stopped
    environment:
      POSTGRES_DB: alpacode
      POSTGRES_USER: alpacode
      POSTGRES_PASSWORD: alpacode
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      # Auto-run schema on first start
      - ./src/main/resources/schema.sql:/docker-entrypoint-initdb.d/01-schema.sql:ro
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U alpacode -d alpacode"]
      interval: 10s
      timeout: 5s
      retries: 5

volumes:
  postgres_data:
